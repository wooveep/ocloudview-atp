# ATP 测试配置示例文件
#
# 配置文件搜索路径 (按优先级):
# 1. ATP_TEST_CONFIG 环境变量指定的路径
# 2. ./test.toml (当前目录)
# 3. ./tests/config.toml (tests 目录)
# 4. ~/.config/atp/test.toml (用户配置目录)
# 5. /etc/atp/test.toml (系统配置目录)
#
# 环境变量可以覆盖配置文件中的值

# ============================================
# 环境配置
# ============================================
[environment]
# 测试模式: unit | integration | e2e
mode = "e2e"

# 日志级别: debug | info | warn | error
log_level = "info"

# ============================================
# Libvirt 配置
# ============================================
[libvirt]
# Libvirt URI
# 环境变量: ATP_TEST_HOST
uri = "qemu:///system"

# 连接超时 (秒)
connect_timeout = 10

# 心跳间隔 (秒)
heartbeat_interval = 30

# 自动重连
auto_reconnect = true

# ============================================
# 虚拟机配置
# ============================================
[vm]
# VM 名称
# 环境变量: ATP_TEST_VM
name = "test-vm"

# 登录用户 (可选)
# 环境变量: ATP_TEST_VM_USER
user = "test"

# 登录密码 (可选)
# 环境变量: ATP_TEST_VM_PASSWORD
password = "test123"

# 等待启动时间 (秒)
wait_boot = 30

# ============================================
# 协议配置
# ============================================

[protocols.qmp]
# QMP Socket 路径前缀
# 环境变量: ATP_QMP_SOCKET
socket_prefix = "/var/lib/libvirt/qemu/"

# 超时 (秒)
timeout = 30

[protocols.qga]
# 超时 (秒)
timeout = 60

# 等待命令执行完成
wait_exec = true

[protocols.spice]
# SPICE 服务器地址
# 环境变量: ATP_SPICE_HOST
host = "localhost"

# SPICE 端口
# 环境变量: ATP_SPICE_PORT
port = 5900

# 超时 (秒)
timeout = 30

[protocols.virtio_serial]
# VirtioSerial 通道路径前缀
channel_prefix = "/var/lib/libvirt/qemu/channel/"

# 超时 (秒)
timeout = 30

# ============================================
# VDI 平台配置 (可选)
# ============================================
# 取消注释以启用 VDI 平台测试

# [vdi]
# # VDI 平台 API 地址
# # 环境变量: ATP_VDI_BASE_URL
# base_url = "http://192.168.1.11:8088"
#
# # VDI 平台用户名
# # 环境变量: ATP_VDI_USERNAME
# username = "admin"
#
# # VDI 平台密码
# # 环境变量: ATP_VDI_PASSWORD
# password = "admin123"
#
# # 是否验证 SSL 证书
# # 环境变量: ATP_VDI_VERIFY_SSL
# verify_ssl = false
#
# # 连接超时 (秒)
# connect_timeout = 10

# ============================================
# 测试行为配置
# ============================================
[test]
# 默认测试超时 (秒)
# 环境变量: ATP_TEST_TIMEOUT
timeout = 60

# 失败重试次数
# 环境变量: ATP_TEST_RETRY
retry = 3

# 跳过慢速测试
# 环境变量: ATP_TEST_SKIP_SLOW
skip_slow = false

# 测试后清理资源
cleanup = true

# ============================================
# 数据库配置 (可选)
# ============================================
# 取消注释以启用测试报告数据库

# [database]
# # 数据库文件路径
# path = "./test_data.db"
#
# # 自动执行数据库迁移
# auto_migrate = true
#
# # 退出时清理数据库
# cleanup_on_exit = true
